---
import { locales } from "@i18n/utils";

interface Props {
  lang: string;
}

const { lang } = Astro.props;
const { origin, pathname } = Astro.url;

function buildHref(language: string) {
  const cleanPath = pathname.replace(/^\/[a-z]{2}/, "")
  return `${origin}/${language}${cleanPath}`;
}
---

<div class="flex items-center justify-center gap-2">
  {
    Object.entries(locales).map(([language, label], index, array) => (
      <a
        href={buildHref(language)}
        aria-label={`Change language to ${label}`}
        aria-current={language === lang}
        class:list={[
          "flex items-center text-xl font-medium justify-center underline underline-offset-4 hover:opacity-70 transition-opacity",
          language === lang && "pointer-events-none opacity-70 ",

        ]}
      >
        {label}
      </a>
      <span class:list={[index === array.length -1 && "hidden"]}>/</span>
    ))
  }
</div>
